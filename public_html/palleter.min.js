/*! fracgen 2017-04-11 */
function Vec3(){var a=0,b=0,c=0;if(3==arguments.length)a=arguments[0],b=arguments[1],c=arguments[2];else if(1==arguments.length){var d=arguments[0];void 0!==d&&(a=d.x,b=d.y,c=d.z)}else a=Math.random(),b=Math.random(),c=Math.random();this.x=a,this.y=b,this.z=c}function pallete(a,b,c,d,e){if("number"!=typeof a&&"object"!=typeof b&&"object"!=typeof c&&"object"!=typeof d&&"object"!=typeof e)throw new TypeError("pallete wrong arguments","vector.js");return new Vec3(d).mul(a).add(e).mul(2*Math.PI).cos().mul(c).add(b).toRGB()}function drawGradient(a,b,c,d,e,f){for(var g=Math.ceil(b/c),h=0,i=4*c,j=0;j<c;j++){for(var k=0;k<g;k++)e.x+f.x<255&&e.x+f.x>0&&(e.x+=f.x),e.y+f.y<255&&e.y+f.y>0&&(e.y+=f.y),e.z+f.z<255&&e.z+f.z>0&&(e.z+=f.z);a[h]=e.x,h++,a[h]=e.y,h++,a[h]=e.z,h++,a[h]=255,h++}for(var l=0;l<d;l++)a.copyWithin(h,0,i),h+=i}function drawModulo(a,b,c,d,e,f){for(var g=Math.ceil(b/c),h=0,i=4*c,j=0;j<c;j++){for(var k=0;k<g;k++)e.add(f).mod(255);a[h]=e.x,h++,a[h]=e.y,h++,a[h]=e.z,h++,a[h]=255,h++}for(var l=0;l<d;l++)a.copyWithin(h,0,i),h+=i}function drawPallete(a,b,c,d,e,f,g){for(var h,i=1/b,j=0,k=0,l=4*b,m=0;m<b;m++)h=pallete(j,d,e,f,g),j+=i,a[k]=h.x,k++,a[k]=h.y,k++,a[k]=h.z,k++,a[k]=255,k++;for(var n=0;n<c;n++)a.copyWithin(k,0,l),k+=l}Vec3.prototype.sin=function(){return this.x=Math.sin(this.x),this.y=Math.sin(this.y),this.z=Math.sin(this.z),this},Vec3.prototype.cos=function(){return this.x=Math.cos(this.x),this.y=Math.cos(this.y),this.z=Math.cos(this.z),this},Vec3.prototype.add=function(a){return"number"==typeof a?(this.x+=a,this.y+=a,this.z+=a):(this.x+=a.x,this.y+=a.y,this.z+=a.z),this},Vec3.prototype.sub=function(a){return"number"==typeof a?(this.x+=-a,this.y+=-a,this.z+=-a):(this.x+=-a.x,this.y+=-a.y,this.z+=-a.z),this},Vec3.prototype.mul=function(a){return"number"==typeof a?(this.x*=a,this.y*=a,this.z*=a):(this.x*=a.x,this.y*=a.y,this.z*=a.z),this},Vec3.prototype.mod=function(a){return"number"==typeof a?(this.x%=a,this.y%=a,this.z%=a):(this.x%=a.x,this.y%=a.y,this.z%=a.z),this},Vec3.prototype.toRGB=function(){return this.x=Math.round(255*this.x),this.y=Math.round(255*this.y),this.z=Math.round(255*this.z),this},Vec3.prototype.equals=function(a){return"object"==typeof a&&(this===a||this.x==a.x&&this.y==a.y&&this.z==a.z)},onmessage=function(a){var b=new Uint8ClampedArray(a.data.width*a.data.height*4);"pallete"===a.data.color?drawPallete(b,a.data.width,a.data.height,new Vec3(a.data.a),new Vec3(a.data.b),new Vec3(a.data.c),new Vec3(a.data.d)):"simple"===a.data.color?drawGradient(b,a.data.iterations,a.data.width,a.data.height,new Vec3(a.data.start),new Vec3(a.data.speed)):"modulo"===a.data.color&&drawModulo(b,a.data.iterations,a.data.width,a.data.height,new Vec3(a.data.start),new Vec3(a.data.speed)),postMessage({imageData:b})};